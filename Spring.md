# Spring

## AOP

### 动态代理的缺陷

1. 实现类必须要实现接口 -JDK动态代理

2. 无法通过规则制定拦截无需功能增强的方法。

Spring-AOP主要弥补了第二个不足，通过规则设置来拦截方法，并对方法做统一的增强。

### 代理的选择

在spring中，框架会根据目标类是否实现了接口来决定采用哪种动态代理的方式。

如果类实现类接口，那么使用JDK动态代理，否则使用CGLIB动态代理。



### AOP相关术语

**Joinpoint(连接点):**

所谓连接点是指那些被拦截到的点。在spring中，这些点指的是方法，因为spring只支持方法类型的连接点。

**Pointcut(切入点):**

所谓的切入点，就是拦截方法设置的规则

**Advice(通知/增强):**

就是可以设置在方法之前拦截或者方法执行之后拦截或者方法出异常后拦截，或者方法之前和之后都**拦截**。我们将这些拦截场景称为通知/增强。

通知的类型：前置通知、后置通知、异常通知、最终通知、环绕通知。

**Aspect(切面):**

所谓的切面就是我们的拦截**处理类**。

**Weaving(织入)：**

把切面加入到对象，并创建出代理对象的过程。（该过程由Spring来完成）



### 常用注解

- @Aspect

作用：把当前类声明为切面类。

- @Before

作用：把当前方法看成是前置通知。

属性：

value：用于指定切入点表达式，还可以指定切入点表达式的引用。

- @AfterReturning

作用：把当前方法看成是最终通知。报异常，就不执行。

属性：

value：用于指定切入点表达式，还可以指定切入点表达式的引用。

- @AfterThrowing

作用：把当前方法看成是异常通知。只有报异常才执行

属性：

value：用于指定切入点表达式，还可以指定切入点表达式的引用。

- @After

作用：把当前方法看成是后置通知。不管报不报异常都执行

属性：

value：用于指定切入点表达式，还可以指定切入点表达式的引用。

- @Around

作用：把当前方法看成是环绕通知。

属性：

value：用于指定切入点表达式，还可以指定切入点表达式的引用。

- Pointcut

作用：指定切入点表达式

属性：

value：指定表达式的内容